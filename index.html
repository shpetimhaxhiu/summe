<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Welcome to Summarized.me</title>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="//connect.facebook.net/en_US/sdk.js"></script>

	</head>
	<body>
		<script>
		  window.fbAsyncInit = function() {
		    FB.init({
		      appId      : '1850361201901483',
		      cookie     : true,
		      xfbml      : true,
		      version    : 'v2.8'
		    });
		    FB.AppEvents.logPageView();   
		  };

		  (function(d, s, id){
		     var js, fjs = d.getElementsByTagName(s)[0];
		     if (d.getElementById(id)) {return;}
		     js = d.createElement(s); js.id = id;
		     js.src = "//connect.facebook.net/en_US/sdk.js";
		     fjs.parentNode.insertBefore(js, fjs);
		   }(document, 'script', 'facebook-jssdk'));
		</script>

		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<h2>Hello world, this is Summarized.me</h2>

					<fb:login-button 
					  scope="public_profile,email"
					  onlogin="checkLoginState();">
					</fb:login-button>
				<div id="status"></div>
				</div>

			</div>
		</div>

		<script src="js/jquery-3.1.1.min.js" ></script>
		<script src="js/bootstrap.min.js" ></script>
		<script src="js/angular.min.js" ></script>
		<script src="js/app.js" ></script>
		<script>
		  function statusChangeCallback(response) {
		    console.log('statusChangeCallback');
		    console.log(response);
		    if (response.status === 'connected') {
		      testAPI();

		    } else if (response.status === 'not_authorized') {
		      FB.login(function(response) {
		        statusChangeCallback2(response);
		      }, {scope: 'public_profile,email'});

		    } else {
		      alert("not connected, not logged into facebook, we don't know");
		    }
		  }

		  function statusChangeCallback2(response) {
		    console.log('statusChangeCallback2');
		    console.log(response);
		    if (response.status === 'connected') {
		      testAPI();

		    } else if (response.status === 'not_authorized') {
		      console.log('still not authorized!');

		    } else {
		      alert("not connected, not logged into facebook, we don't know");
		    }
		  }

		  function checkLoginState() {
		    FB.getLoginStatus(function(response) {
		      statusChangeCallback(response);
		    });
		  }

		  function testAPI() {
		    console.log('Welcome!  Fetching your information.... ');
		    FB.api('/me', function(response) {
		    	alert('Tungjat' + response.name)
		      console.log('Successful login for: ' + response.name);
		      document.getElementById('status').innerHTML =
		        'Thanks for logging in, ' + response.name + '!';
		    });
		  }

		  $(document).ready(function() {
		    FB.init({
		      appId      : '1850361201901483',
		      cookie     : true,
		      xfbml      : true,
		      version    : 'v2.8'
		    });
		    checkLoginState();
		  });
		</script>
	</body>
</html>